@model API.Models.LoginRequest
<!DOCTYPE html>
<!-- Created By CodingNepal -->
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="~/css/login.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
</head>

<body>
    <div class="login-container">
        <div class="content">
            <div class="text">
                Login Form
            </div>

            <!-- Other HTML code -->
            <div class="validation-summary-errors">
                @* @if (!string.IsNullOrEmpty(ViewData["ErrorMessage"] as string))
                {
                <p class="text-danger">@Html.Raw(ViewData["ErrorMessage"])</p>
                } *@
            </div>
            <!-- Other HTML code -->

            <div class="field">
                <input type="text" asp-for="Email" id="Email" placeholder="Email Id">
                <span class="fas fa-envelope"></span>
                <label>Email or Phone</label>
            </div>
            <span asp-validation-for="Email" class="text-danger"></span>

            <div class="field">
                <input type="password" id="Password" asp-for="Password" placeholder="Password">
                <span class="fas fa-lock"></span>
                <label>Password</label>
            </div>
            <span asp-validation-for="Password" class="text-danger"></span>

            <div class="forgot-pass">
                <a href="#">Forgot Password?</a>
            </div>
            <button onclick="Login()">Sign in</button>
            <div class="sign-up">
                Not a member?
                <a asp-controller="MvcUser" asp-action="Register">signup now</a>
            </div>

        </div>
    </div>
</body>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>


<script>
    function Login() {
        var email = $('#Email').val();
        console.log(email);
        var user = {
            Email: $('#Email').val(),
            Password: $('#Password').val()
        };

        $.ajax({
            url: 'https://localhost:7072/api/UserApi/Login',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(user),
            success: function (response) {
                console.log("in login  username" + response.username);
                console.log("in login userid" + response.userid);
                sessionStorage.setItem('username', response.username);
                sessionStorage.setItem('userid', response.userid);
                
                alert('Successfully Logged In!');
                if (response.username === "admin") {
                    window.location = '/MvcAdmin/Index';
                } else {
                    window.location = '/MvcEmployee/Index';
                }
            },
            error: function (xhr, status, error) {
                console.error('Login failed:', error);
                alert('Login failed. Please try again.');
            }
        });


    }


</script>


</html>
